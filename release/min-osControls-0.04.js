(function(){var e={},t=function(){!function(e){e.fileExplorer=function(){_e().createClass("osMenu",{css:function(e){e.bind(".topMenuArea",{width:"100%",background:"#fae9e6","font-family":"Arial","font-size":"14px"}),e.bind(".menuItem",{display:"table-cell",padding:"10px 4px 4px 10px"}),e.bind(".menuItem:hover",{background:_e().mix("#fae9e6","#999",.2)})},init:function(){this.addClass("topMenuArea"),this.mvc(this.model().items,function(e){return _e("div",function(){this.addClass("menuItem"),this.text(e.get("title"))})})}}),_e().createClass("actionItem",{init:function(){var e=this.model();e.get("icon")&&this.span("icon").span(e.get("icon")),this.span("title").bind(e,"title"),e.get("action")&&this.clickTo(e.get("action"),e)},tagName:"span"}),_e().createClass("showFile",{css:function(e){e.bind(".fileArea",{"background-color":"white",width:"100%",height:"600px","text-align":"center",padding:"20px"}),e.bind(".prevImage",{"max-height":"500px"})},init:function(){this.addClass("fileArea");var e=this.model(),t=this;if(e.hasOwn("appUrl")){var i=umo(i.get("appUrl"));i.then(function(){var e=i.get("comp");if(e)if(i.hasOwn("compDataUrl")){var n=umo(i.get("compDataUrl"));n.then(function(){t.e(e,n)})}else t.e(e,i.compData);else;})}if(e.hasOwn("app")){var i=e.app,n=i.get("comp");if(n){if(i.hasOwn("compDataUrl")){var o=umo(i.get("compDataUrl")),t=this;o.then(function(){t.e(n,o)})}else this.e(n,i.compData);return}}this.pre().text(JSON.stringify(e.toPlainData()));this.div().img("prevImage").src("http://static.parade.com/wp-content/uploads/2014/03/Why-Do-Stars-All-Look-Almost-the-Same-Size-ftr.jpg").width("auto");this.h4().bind(this.model(),"title")}}),_e().createClass("deepAppleMenu",{requires:{css:[{url:"https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"}]},css:function(e){e.bind("div.me",{opacity:.4}),e.bind(".area",{display:"table-row"}),e.bind(".naviBtn",{border:"1px solid #222","background-color":"#aaa",color:"#aaa","border-radius":"4px",outline:"none",cursor:"pointer",background:"linear-gradient(#333,#666)"}),e.bind(".naviBtn:hover",{color:"white"}),e.bind(".nextLevel",{display:"table-cell","white-space":"nowrap"}),e.bind(".ddContent",{"background-color":"white",padding:"0px","border-top":"2px solid gray","font-family":"Helvetica","font-size":"14px",display:"table-cell","vertical-align":"top","text-align":"top",height:"600px",width:"200px",overflow:"auto"}),e.bind(".ddList",{height:"600px",overflow:"auto",width:"200px"}),e.bind(".ddContentItem",{"border-top":"1px solid gray",padding:"3px","background-color":"#eee",cursor:"pointer",color:"#666"}),e.bind(".active",{"background-color":_e().mix("#459","white",.6),color:"black"}),e.bind(".fa-folder",{color:"#6ec3e5","text-shadow":"0px 1px 1px black"}),e.bind(".fa-clone",{color:"gold","float":"right","text-shadow":"0px 1px 1px black"}),e.bind(".fa-file",{color:"#eef","text-shadow":"0px 1px 1px black "}),e.bind(".title",{"margin-left":"6px"}),e.bind(".ddContentItem:hover",{"text-decoration":"underline",color:"#222"})},setActive:function(e){var t=_data(e);this.addClass("area");for(var i=t.parent(),n=0;i;)n++,i=i.parent();if(n--,6>n&&(n=0),this.sendMsg("moveToLevel",.2*n),t&&t.hasOwn("items")&&t.items.length()>=0)return this._nextLevel.pushView(_e("deepAppleMenu",t)),this.sendMsg("activeFolder",t),void this.sendMsg("editTarget",t);this.sendMsg("openMedia",t),this.sendMsg("editTarget",t),this.sendMsg("activeFile",t);var i=t.parent();if(i.parent()?this.sendMsg("activeFolder",t.parent().parent()):this.sendMsg("activeFolder",null),this._activeItem){if(this._activeItem==t)return;this._activeItem.set("active",!1)}this._activeItem=t,this._activeItem.set("active",!0)},init:function(){this._toolBar=this.div();var e=this.div("ddContent"),t=this;return e.on("mouseenter",function(){t.sendMsg("dropTarget",this.model())}),this._contentArea=e,this._nextLevel=this.div("nextLevel"),e.div("ddList").mvc(this.model().items,function(e){return _e("div",function(){e.set("active",!1),this.addClass("ddContentItem"),this.actionItem(e),e.get("active")&&this.addClass("active");var t=this;if(e.on("active",function(){e.get("active")?t.addClass("active"):t.removeClass("active")}),e.hasOwn("variants")){var i=this.span("fa fa-clone");i.clickTo("showVariants",e),i.touchclick()}this.on("click",function(){e.get("active")?t.sendMsg("renameFile",t):t.sendMsg("setActive",e)}),this.on("dblclick",function(){this.sendMsg("openFile")}),this.on("mouseenter",function(){t.addClass("me"),t.sendMsg("dropTarget",e)}),this.on("mouseleave",function(){t.removeClass("me")}),this.touchclick(),this.drag(function(i){i.start&&t.sendMsg("dragStart",e),i.end&&t.sendMsg("dragEnd",e)})})}),e}}),_e().createClass("fileToolbar",{css:function(e){e.bind(".area",{width:"100%",background:"#eee"}),e.bind(".toolBtn",{border:"1px solid #aaa","background-color":"#aaa",color:"#333","border-radius":"0px",padding:"4px",outline:"none",cursor:"pointer",background:"linear-gradient(#fff,#eee)"})},init:function(){this.addClass("area"),this.button("toolBtn").text("+ YouTube").clickTo("addYouTube",{comp:"youTube",compData:{url:"https://www.youtube.com/embed/Sj_9CiNkkn4"}}),this.button("toolBtn").text("+ Folder").clickTo("addFolder"),this.button("toolBtn").text("+ File").clickTo("addFile"),this.button("toolBtn").text("Open").clickTo("openFile"),this.button("toolBtn").text("Copy").clickTo("copyFile"),this.button("toolBtn").text("Delete").clickTo("deleteFile"),this.button("toolBtn").text("Rename").clickTo("renameFile")}}),_e().createClass("fullFileDisplay",{css:function(e){e.bind(".area",{width:"100%",color:"#554"}),e.bind(".msg",{"line-height":1,"font-size":"3em","text-align":"center","font-family":"Arial"}),e.bind(".msg button",{padding:"2em","font-size":"1.5em",border:"none"})},init:function(){this.addClass("area"),this.div("msg",function(){this.h2().text("We could open with some app the file "+this.model().get("title")),this.button().text("Go back").on("click",function(){this.popView()})})}}),_e().createClass("fileExplorer",{css:function(e){e.bind(".mediaFilerow",{display:"table-row"}),e.bind(".mediaFilerowItem",{display:"table-cell"}),e.bind(".explorer",{width:"100%","background-color":"#fff"}),e.bind("input.editTitle",{width:"100%","font-size":"15px",padding:"4px"}),e.bind(".backBtn",{border:"1px solid #aaa","background-color":"#aaa",color:"#333","border-radius":"10px",padding:"5px","font-size":"12px",outline:"none",margin:"5px",cursor:"pointer",background:"linear-gradient(#fefefe,#e7e7e7)"}),e.bind(".variantsHead",{background:"#676767",color:"white","font-family":"Arial","font-size":"1.2em",padding:"0.5em",cursor:"pointer"})},addYouTube:function(){function e(e){var t=e.indexOf("?v=");if(t){var i=e.substring(t+3,3+t+"WyZHXoOKYW4".length);return i}}var t=prompt("Give the URL of the YouTube video");if(t){var i={comp:"youTube",compData:{url:"https://www.youtube.com/embed/"+e(t)}};this.send("addFile",i)}},addFile:function(e){if(!this._activeFolder){var t=prompt("Give new name to file");if(t){this.model().push(e?{title:t,icon:"fa fa-file",viewClass:"dataView1",active:!1,app:e}:{title:t,icon:"fa fa-file",viewClass:"dataView1",active:!1});var i=this.model(),n=i.at(i.length()-1);n.moveToIndex(0)}}if(this._activeFolder&&this._activeFolder.items){var t=prompt("Give new name to file");if(t){this._activeFolder.items.push(e?{title:t,icon:"fa fa-file",viewClass:"dataView1",active:!1,app:e}:{title:t,icon:"fa fa-file",viewClass:"dataView1",active:!1});var i=this._activeFolder.items,n=i.at(i.length()-1);n.moveToIndex(0)}}},addFolder:function(){if(!this._activeFolder){var e=prompt("Give new name to folder");if(e){var t=this.model();if(t.isArray()||(t=t.items),!t)return;t.push({title:e,icon:"fa fa-folder",viewClass:"dataView1",active:!1,items:[]});var i=t.at(n.length()-1);i.moveToIndex(0)}}if(this._activeFolder&&this._activeFolder.items){var e=prompt("Give new name to folder");if(e){this._activeFolder.items.push({title:e,icon:"fa fa-folder",viewClass:"dataView1",active:!1,items:[]});var n=this._activeFolder.items,i=n.at(n.length()-1);i.moveToIndex(0)}}else console.log(this._activeFolder)},openFile:function(){this._activeFile&&this._contentArea.pushView(_e("fullFileDisplay",this._activeFile))},renameFile:function(e){if(this._editTarget){if(e){var t=this._editTarget,i=e,n=_e("div",function(){var e=this;setTimeout(function(){var o=e.input("editTitle");o.val(t.get("title")).on("blur",function(){var e=o.val();e.length>0&&t.set("title",e),n.replaceWith(i)}).focus(),o._dom.select(),e._dom.addEventListener("click",function(){})},1)});return void i.replaceWith(n)}var o=prompt("Give new name to file");o&&this._editTarget.set("title",o)}},copyFile:function(){this._editTarget&&alert("Should copy file "+this._editTarget.get("title"))},deleteFile:function(){this._editTarget&&this._editTarget.remove()},activeFolder:function(e){if(console.log("activeFolder ",e),!e)return void(this._activeFolder=null);var t=_data(e);return this.model().parent()==t?void(this._activeFolder=null):void(this._activeFolder=_data(e))},activeFile:function(e){this._activeFile=_data(e)},editTarget:function(e){this._editTarget=_data(e)},moveToNext:function(){if(this._editTarget){return}},dragEnd:function(){if(this._dropTarget&&this._dropTarget!=this._dragItem){if(this._dragItem.items)for(var e=this._dropTarget;e;){if(e==this._dragItem)return;e=e.parent()}if(this._dropTarget.items&&this._dragItem.items){this._dropTarget.items.push(this._dragItem.toPlainData()),this._dragItem.remove();var t=this._dropTarget.items,i=t.at(t.length()-1);return void i.moveToIndex(0)}var n,o=0;if(this._dropTarget.items||(o=this._dropTarget.indexOf(),n=this._dropTarget.parent()),this._dropTarget.items&&(n=this._dropTarget.items),n||(n=this.model()),n&&this._dragItem){n.push(this._dragItem.toPlainData()),this._dragItem.remove();var t=n,i=t.at(t.length()-1);i.moveToIndex(o)}}},openMedia:function(e){this.sendMsg("openApplication",e)},dropTarget:function(e){var t=_data(e);t.getID()&&(this._dropTarget=t)},dragStart:function(e){var t=_data(e);this._dragItem=t,this._dropTarget=null},ctrlDown:function(){this._ctrlDown=!0},ctrlUp:function(){this._ctrlDown=!1},shiftDown:function(){this._shiftDown=!0},shiftUp:function(){this._shiftDown=!1},moveToLevel:function(e){var t=this;if(t._folderLevel||(t._folderLevel=0),e!=t._folderLevel){var i=this._contentArea._dom,n=t._folderLevel;t._folderLevel=n;var o=200;console.log(e),later().ease("pow",400,function(t){i.style.marginLeft=-1*(n*(1-t)*o+e*t*o)+"px"},function(){t._folderLevel=e})}},showVariants:function(e){var t=_data(e);if(e&&t&&t.variants){this._mainView.pushView(_e("div",function(){this.div("variantsHead",function(){this.span("fa fa-arrow-circle-left"),this.span().text(" "),this.span().text("variants of file "+t.get("title"))}).on("click",function(){this.popView()}),this.fileExplorer(t.variants)}))}},init:function(){function e(e){e=e||window.event,console.log("Up "+e.keyCode),16==e.keyCode&&n.sendMsg("shiftUp"),9==e.keyCode&&n.sendMsg("moveToNext"),17==e.keyCode&&n.sendMsg("ctrlUp"),50==e.keyCode&&n.sendMsg("renameFile")}function t(e){e=e||window.event,console.log(e.keyCode),16==e.keyCode&&n.sendMsg("shiftDown"),17==e.keyCode&&n.sendMsg("ctrlDown")}this._mediaView=this.div("mediaFilerow"),this._mainView=this,this._activeModel=this.model(),this._dragList=[],this.addClass("explorer"),this.div().fileToolbar(),this._infoDiv=this.div();var i=this.div("fileBrowser");i.deepAppleMenu(this.model()),this._contentArea=i,document.onkeydown=t,document.onkeyup=e;var n=this}}),_e().createClass("osManager",{css:function(e){e.bind(".mediaFilerow",{display:"table-row"}),e.bind(".mediaFilerowItem",{display:"table-cell"})},openApplication:function(e){var t=_data(e),i=this;if(t.hasOwn("appUrl")){var n=umo(t.get("appUrl"));return void n.then(function(){var e=n.get("comp");if(e)if(n.hasOwn("compDataUrl")){var t=umo(n.get("compDataUrl"));t.then(function(){i._mediaView.prepend(_e("div",function(){i.addClass("mediaFilerowItem"),i.e(e,t)}))})}else i._mediaView.prepend(_e("div",function(){this.addClass("mediaFilerowItem"),this.e(e,n.compData)}));else;})}if(t.hasOwn("app")){var n=t.app,o=n.get("comp");if(o)return void this._mediaView.prepend(_e("div",function(){this.addClass("mediaFilerowItem"),this.e(o,n.compData)}))}},init:function(){console.log("--- called the osManager ---"),this._mediaView=this.div("mediaFilerow"),this.fileExplorer(this.model())}})},e.__traitInit&&!e.hasOwnProperty("__traitInit")&&(e.__traitInit=e.__traitInit.slice()),e.__traitInit||(e.__traitInit=[]),e.__traitInit.push(function(){this.fileExplorer()})}(this)},i=function(e,t,n,o,a,s,r,d){var l,c=this;if(!(c instanceof i))return new i(e,t,n,o,a,s,r,d);var h=[e,t,n,o,a,s,r,d];if(c.__factoryClass)if(c.__factoryClass.forEach(function(e){l=e.apply(c,h)}),"function"==typeof l){if(l._classInfo.name!=i._classInfo.name)return new l(e,t,n,o,a,s,r,d)}else if(l)return l;c.__traitInit?c.__traitInit.forEach(function(e){e.apply(c,h)}):"function"==typeof c.init&&c.init.apply(c,h)};i._classInfo={name:"osControls"},i.prototype=new t,function(){"undefined"!=typeof define&&null!==define&&null!=define.amd?(e.osControls=i,this.osControls=i):"undefined"!=typeof module&&null!==module&&null!=module.exports?module.exports.osControls=i:this.osControls=i}.call(new Function("return this")()),"undefined"!=typeof define&&null!==define&&null!=define.amd&&define(e),i()}).call(new Function("return this")());